#include <satemu/db/ipl_db.hpp>

#include <unordered_map>

template <>
struct std::hash<satemu::XXH128Hash> {
    size_t operator()(const satemu::XXH128Hash &e) const noexcept {
        uint64_t low = 0;
        uint64_t high = 0;
        for (size_t i = 0; i < 8; i++) {
            low |= static_cast<uint64_t>(e[i]) << (i * 8ull);
            high |= static_cast<uint64_t>(e[i + 8]) << (i * 8ull);
        }
        return std::hash<uint64_t>{}(low) ^ std::hash<uint64_t>{}(high);
    }
};

namespace satemu::db {

// clang-format off
static const std::unordered_map<XXH128Hash, IPLROMInfo> kIPLInfos = {
    {{0x72,0xc0,0x81,0xc9,0xae,0x6c,0x58,0x61,0x50,0xa8,0x16,0x64,0xad,0x98,0xe5,0x2f}, {"sega_100.bin",  "1.00",  1994,  9, 21, SystemVariant::SaturnJP}},
    {{0xd1,0xb6,0x9e,0x02,0x94,0x49,0xd5,0x69,0x92,0x96,0x13,0x58,0x1a,0x6b,0xb3,0x81}, {"sega_101.bin",  "1.01",  1994, 12, 28, SystemVariant::SaturnJP}},
    {{0x80,0x27,0x5d,0x4a,0xcd,0xcb,0xc8,0xc9,0xc5,0xab,0x8d,0x19,0xb8,0x76,0x19,0x50}, {"sega_100a.bin", "1.00a", 1994, 11, 15, SystemVariant::SaturnUS_EU}},
    {{0xd4,0x90,0x63,0xdd,0x53,0x20,0xc8,0xc7,0xb1,0x98,0x90,0x60,0x78,0x4c,0xec,0xb8}, {"mpr-17933.bin", "1.01a", 1994, 11, 15, SystemVariant::SaturnUS_EU}},
    {{0xcf,0xb4,0xcc,0xc9,0x88,0xc9,0x68,0xf0,0x2c,0xc9,0x4d,0x48,0x1d,0x4d,0x1b,0x49}, {"hisaturn.bin",  "1.01",  1995,  1, 30, SystemVariant::HiSaturn}},
    {{0xbf,0x93,0xca,0x69,0x46,0x6e,0x5f,0x42,0x0a,0x48,0xa6,0xe7,0xd4,0xdc,0xb1,0x69}, {"mpr-18100.bin", "1.02",  1995,  5, 19, SystemVariant::HiSaturn}},
    {{0xe5,0x28,0x67,0xb6,0x4f,0x10,0x62,0x18,0xa9,0x56,0xae,0xd5,0x18,0x0a,0x04,0xc2}, {"gamenavi.bin",  "1.03",  1995,  7, 20, SystemVariant::GameNaviHiSaturn}},
    {{0xf3,0x69,0x34,0x15,0x55,0x26,0x8d,0x20,0x3b,0x9c,0xca,0xea,0x60,0x38,0xe4,0xd6}, {"samsung.bin",   "1.02a", 1994, 11, 15, SystemVariant::SamsungSaturn}},
    {{0x75,0xfd,0x71,0x5c,0x6b,0xbf,0x8e,0x20,0x27,0x8f,0x31,0x9b,0x05,0x7a,0x2d,0x76}, {"vsaturn.bin",   "1.01",  1995,  7,  3, SystemVariant::VSaturn}},
    {{0x2e,0x8a,0x93,0x9f,0x64,0x40,0xdd,0xd2,0xaa,0xd1,0xf5,0x2c,0x25,0x77,0x4b,0x18}, {"sega1003.bin",  "1.003", 1994, 10, 12, SystemVariant::DevKit}},
};
// clang-format on	
	
const IPLROMInfo *GetIPLROMInfo(XXH128Hash hash) {
    if (kIPLInfos.contains(hash)) {
        return &kIPLInfos.at(hash);
    } else {
        return nullptr;
    }
}

} // namespace satemu::db
