#include <satemu/db/ipl_db.hpp>

#include <unordered_map>

template <>
struct std::hash<satemu::XXH128Hash> {
    size_t operator()(const satemu::XXH128Hash &e) const noexcept {
        uint64_t low = 0;
        uint64_t high = 0;
        for (size_t i = 0; i < 8; i++) {
            low |= static_cast<uint64_t>(e[i]) << (i * 8ull);
            high |= static_cast<uint64_t>(e[i + 8]) << (i * 8ull);
        }
        return std::hash<uint64_t>{}(low) ^ std::hash<uint64_t>{}(high);
    }
};

namespace satemu::db {

// clang-format off
static const std::unordered_map<XXH128Hash, IPLROMInfo> kIPLInfos = {
    {{0x72,0xc0,0x81,0xc9,0xae,0x6c,0x58,0x61,0x50,0xa8,0x16,0x64,0xad,0x98,0xe5,0x2f}, {"1.00",  1994,  9, 21, SystemVariant::Saturn,   SystemRegion::JP}},
    {{0xd1,0xb6,0x9e,0x02,0x94,0x49,0xd5,0x69,0x92,0x96,0x13,0x58,0x1a,0x6b,0xb3,0x81}, {"1.01",  1994, 12, 28, SystemVariant::Saturn,   SystemRegion::JP}},
    {{0x80,0x27,0x5d,0x4a,0xcd,0xcb,0xc8,0xc9,0xc5,0xab,0x8d,0x19,0xb8,0x76,0x19,0x50}, {"1.00a", 1994, 11, 15, SystemVariant::Saturn,   SystemRegion::US_EU}},
    {{0xd4,0x90,0x63,0xdd,0x53,0x20,0xc8,0xc7,0xb1,0x98,0x90,0x60,0x78,0x4c,0xec,0xb8}, {"1.01a", 1994, 11, 15, SystemVariant::Saturn,   SystemRegion::US_EU}},
    {{0xf3,0x69,0x34,0x15,0x55,0x26,0x8d,0x20,0x3b,0x9c,0xca,0xea,0x60,0x38,0xe4,0xd6}, {"1.02a", 1994, 11, 15, SystemVariant::Saturn,   SystemRegion::KR}},
    {{0xcf,0xb4,0xcc,0xc9,0x88,0xc9,0x68,0xf0,0x2c,0xc9,0x4d,0x48,0x1d,0x4d,0x1b,0x49}, {"1.01",  1995,  1, 30, SystemVariant::HiSaturn, SystemRegion::JP}},
    {{0xbf,0x93,0xca,0x69,0x46,0x6e,0x5f,0x42,0x0a,0x48,0xa6,0xe7,0xd4,0xdc,0xb1,0x69}, {"1.02",  1995,  5, 19, SystemVariant::HiSaturn, SystemRegion::JP}},
    {{0xe5,0x28,0x67,0xb6,0x4f,0x10,0x62,0x18,0xa9,0x56,0xae,0xd5,0x18,0x0a,0x04,0xc2}, {"1.03",  1995,  7, 20, SystemVariant::HiSaturn, SystemRegion::JP}},
    {{0x75,0xfd,0x71,0x5c,0x6b,0xbf,0x8e,0x20,0x27,0x8f,0x31,0x9b,0x05,0x7a,0x2d,0x76}, {"1.01",  1995,  7,  3, SystemVariant::VSaturn,  SystemRegion::JP}},
    {{0x2e,0x8a,0x93,0x9f,0x64,0x40,0xdd,0xd2,0xaa,0xd1,0xf5,0x2c,0x25,0x77,0x4b,0x18}, {"1.003", 1994, 10, 12, SystemVariant::DevKit,   SystemRegion::JP}},

    {{0x59,0x84,0xf8,0xd1,0xf3,0x0c,0x70,0xf6,0xcd,0x52,0xd5,0x79,0x7b,0x13,0x20,0xa8}, {"1.00",  1994,  9, 21, SystemVariant::Saturn,   SystemRegion::RegionFree}},
    {{0xf3,0x4b,0xa4,0xef,0xc8,0xc8,0x6d,0xf0,0x6b,0x86,0x0f,0x98,0x5a,0xb9,0x85,0x91}, {"1.01",  1994, 12, 28, SystemVariant::Saturn,   SystemRegion::RegionFree}},
    {{0x55,0xc1,0xa9,0xfe,0x4c,0xb6,0x28,0x45,0x83,0x5f,0x94,0x67,0x12,0x76,0x39,0x8c}, {"1.00a", 1994, 11, 15, SystemVariant::Saturn,   SystemRegion::RegionFree}},
    {{0x55,0xc1,0xa9,0xfe,0x4c,0xb6,0x28,0x45,0x83,0x5f,0x94,0x67,0x12,0x76,0x39,0x8c}, {"1.01a", 1994, 11, 15, SystemVariant::Saturn,   SystemRegion::RegionFree}},
    {{0x93,0x35,0x51,0xed,0x20,0xc1,0x3e,0x93,0xdb,0xb3,0x40,0x0c,0x63,0x53,0x89,0x85}, {"1.02a", 1994, 11, 15, SystemVariant::Saturn,   SystemRegion::RegionFree}},
    {{0xf1,0xad,0x09,0xac,0x60,0x5d,0x59,0x82,0x82,0x36,0x09,0xcf,0x10,0xc8,0x0a,0x49}, {"1.01",  1995,  1, 30, SystemVariant::HiSaturn, SystemRegion::RegionFree}},
    {{0xa1,0x55,0x32,0x69,0x7d,0x40,0xb0,0x11,0x3c,0xcd,0x38,0x0c,0xcb,0x9f,0x8e,0x76}, {"1.02",  1995,  5, 19, SystemVariant::HiSaturn, SystemRegion::RegionFree}},
    {{0x83,0xc3,0x6e,0x72,0xa6,0x5c,0x85,0xa1,0x53,0x7d,0x82,0xa4,0x9c,0xa3,0x16,0x32}, {"1.03",  1995,  7, 20, SystemVariant::HiSaturn, SystemRegion::RegionFree}},
    {{0x48,0x6a,0x9d,0x65,0x02,0x2e,0x41,0x2a,0x92,0xb0,0xef,0x71,0x9c,0xc0,0x1a,0x39}, {"1.01",  1995,  7,  3, SystemVariant::VSaturn,  SystemRegion::RegionFree}},
};
// clang-format on

const IPLROMInfo *GetIPLROMInfo(XXH128Hash hash) {
    if (kIPLInfos.contains(hash)) {
        return &kIPLInfos.at(hash);
    } else {
        return nullptr;
    }
}

} // namespace satemu::db
